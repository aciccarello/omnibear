!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=19)}([function(e,t,n){"use strict";var o=n(4),r=n(10),i=n.n(r),a=function(e,t){let n={},o=t;const r=(new DOMParser).parseFromString(e,"text/html"),i=r.querySelector("base[href]"),a=r.querySelectorAll("[rel][href]");if(i){const e=i.getAttribute("href"),n=new URL(e,t);o=n.toString()}return a.length&&a.forEach(e=>{const t=e.getAttribute("rel").toLowerCase().split("\\s+"),r=e.getAttribute("href");t.length&&null!==r&&t.forEach(e=>{n[e]||(n[e]=[]);const t=new URL(r,o).toString();-1===n[e].indexOf(t)&&n[e].push(t)})}),n};function s(e,t=new FormData,n=!1){return Object.keys(e).forEach(o=>{const r=e[o];n&&(o=n+"["+o+"]"),Array.isArray(r)?r.forEach(e=>{const n={};n[o+"[]"]=e,t=s(n,t)}):t.append(o,r)}),t}function u(e,t){const n=-1==e.indexOf("?")?"?":"&";let o=[];for(var r in t)Array.isArray(t[r])?t[r].forEach(e=>{o.push(r+"[]="+encodeURIComponent(e))}):o.push(r+"="+encodeURIComponent(t[r]));return e+n+o.join("&")}n.d(t,"g",function(){return o.parse}),n.d(t,"h",function(){return o.stringify}),n.d(t,"e",function(){return i.a}),n.d(t,"i",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"d",function(){return u})},function(e,t,n){"use strict";n.r(t),n.d(t,"h",function(){return s}),n.d(t,"createElement",function(){return s}),n.d(t,"cloneElement",function(){return c}),n.d(t,"Component",function(){return N}),n.d(t,"render",function(){return R}),n.d(t,"rerender",function(){return h}),n.d(t,"options",function(){return r});var o=function(){},r={},i=[],a=[];function s(e,t){var n,s,u,l,c=a;for(l=arguments.length;l-- >2;)i.push(arguments[l]);for(t&&null!=t.children&&(i.length||i.push(t.children),delete t.children);i.length;)if((s=i.pop())&&void 0!==s.pop)for(l=s.length;l--;)i.push(s[l]);else"boolean"==typeof s&&(s=null),(u="function"!=typeof e)&&(null==s?s="":"number"==typeof s?s=String(s):"string"!=typeof s&&(u=!1)),u&&n?c[c.length-1]+=s:c===a?c=[s]:c.push(s),n=u;var p=new o;return p.nodeName=e,p.children=c,p.attributes=null==t?void 0:t,p.key=null==t?void 0:t.key,void 0!==r.vnode&&r.vnode(p),p}function u(e,t){for(var n in t)e[n]=t[n];return e}var l="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function c(e,t){return s(e.nodeName,u(u({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var p=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,f=[];function d(e){!e._dirty&&(e._dirty=!0)&&1==f.push(e)&&(r.debounceRendering||l)(h)}function h(){var e,t=f;for(f=[];e=t.pop();)e._dirty&&M(e)}function y(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function g(e){var t=u({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var o in n)void 0===t[o]&&(t[o]=n[o]);return t}function b(e){var t=e.parentNode;t&&t.removeChild(e)}function m(e,t,n,o,r){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),o&&o(e);else if("class"!==t||r)if("style"===t){if(o&&"string"!=typeof o&&"string"!=typeof n||(e.style.cssText=o||""),o&&"object"==typeof o){if("string"!=typeof n)for(var i in n)i in o||(e.style[i]="");for(var i in o)e.style[i]="number"==typeof o[i]&&!1===p.test(i)?o[i]+"px":o[i]}}else if("dangerouslySetInnerHTML"===t)o&&(e.innerHTML=o.__html||"");else if("o"==t[0]&&"n"==t[1]){var a=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),o?n||e.addEventListener(t,v,a):e.removeEventListener(t,v,a),(e._listeners||(e._listeners={}))[t]=o}else if("list"!==t&&"type"!==t&&!r&&t in e){try{e[t]=null==o?"":o}catch(e){}null!=o&&!1!==o||"spellcheck"==t||e.removeAttribute(t)}else{var s=r&&t!==(t=t.replace(/^xlink:?/,""));null==o||!1===o?s?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof o&&(s?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),o):e.setAttribute(t,o))}else e.className=o||""}function v(e){return this._listeners[e.type](r.event&&r.event(e)||e)}var _=[],w=0,O=!1,E=!1;function j(){for(var e;e=_.pop();)r.afterMount&&r.afterMount(e),e.componentDidMount&&e.componentDidMount()}function k(e,t,n,o,r,i){w++||(O=null!=r&&void 0!==r.ownerSVGElement,E=null!=e&&!("__preactattr_"in e));var a=function e(t,n,o,r,i){var a=t,s=O;if(null!=n&&"boolean"!=typeof n||(n=""),"string"==typeof n||"number"==typeof n)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||i)?t.nodeValue!=n&&(t.nodeValue=n):(a=document.createTextNode(n),t&&(t.parentNode&&t.parentNode.replaceChild(a,t),S(t,!0))),a.__preactattr_=!0,a;var u,l,c=n.nodeName;if("function"==typeof c)return function(e,t,n,o){for(var r=e&&e._component,i=r,a=e,s=r&&e._componentConstructor===t.nodeName,u=s,l=g(t);r&&!u&&(r=r._parentComponent);)u=r.constructor===t.nodeName;return r&&u&&(!o||r._component)?(L(r,l,3,n,o),e=r.base):(i&&!s&&(A(i),e=a=null),r=T(t.nodeName,l,n),e&&!r.nextBase&&(r.nextBase=e,a=null),L(r,l,1,n,o),e=r.base,a&&e!==a&&(a._component=null,S(a,!1))),e}(t,n,o,r);if(O="svg"===c||"foreignObject"!==c&&O,c=String(c),(!t||!y(t,c))&&(u=c,(l=O?document.createElementNS("http://www.w3.org/2000/svg",u):document.createElement(u)).normalizedNodeName=u,a=l,t)){for(;t.firstChild;)a.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(a,t),S(t,!0)}var p=a.firstChild,f=a.__preactattr_,d=n.children;if(null==f){f=a.__preactattr_={};for(var h=a.attributes,v=h.length;v--;)f[h[v].name]=h[v].value}return!E&&d&&1===d.length&&"string"==typeof d[0]&&null!=p&&void 0!==p.splitText&&null==p.nextSibling?p.nodeValue!=d[0]&&(p.nodeValue=d[0]):(d&&d.length||null!=p)&&function(t,n,o,r,i){var a,s,u,l,c,p,f,d,h=t.childNodes,g=[],m={},v=0,_=0,w=h.length,O=0,E=n?n.length:0;if(0!==w)for(var j=0;j<w;j++){var k=h[j],C=k.__preactattr_,P=E&&C?k._component?k._component.__key:C.key:null;null!=P?(v++,m[P]=k):(C||(void 0!==k.splitText?!i||k.nodeValue.trim():i))&&(g[O++]=k)}if(0!==E)for(var j=0;j<E;j++){l=n[j],c=null;var P=l.key;if(null!=P)v&&void 0!==m[P]&&(c=m[P],m[P]=void 0,v--);else if(_<O)for(a=_;a<O;a++)if(void 0!==g[a]&&(p=s=g[a],d=i,"string"==typeof(f=l)||"number"==typeof f?void 0!==p.splitText:"string"==typeof f.nodeName?!p._componentConstructor&&y(p,f.nodeName):d||p._componentConstructor===f.nodeName)){c=s,g[a]=void 0,a===O-1&&O--,a===_&&_++;break}c=e(c,l,o,r),u=h[j],c&&c!==t&&c!==u&&(null==u?t.appendChild(c):c===u.nextSibling?b(u):t.insertBefore(c,u))}if(v)for(var j in m)void 0!==m[j]&&S(m[j],!1);for(;_<=O;)void 0!==(c=g[O--])&&S(c,!1)}(a,d,o,r,E||null!=f.dangerouslySetInnerHTML),function(e,t,n){var o;for(o in n)t&&null!=t[o]||null==n[o]||m(e,o,n[o],n[o]=void 0,O);for(o in t)"children"===o||"innerHTML"===o||o in n&&t[o]===("value"===o||"checked"===o?e[o]:n[o])||m(e,o,n[o],n[o]=t[o],O)}(a,n.attributes,f),O=s,a}(e,t,n,o,i);return r&&a.parentNode!==r&&r.appendChild(a),--w||(E=!1,i||j()),a}function S(e,t){var n=e._component;n?A(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||b(e),C(e))}function C(e){for(e=e.lastChild;e;){var t=e.previousSibling;S(e,!0),e=t}}var P=[];function T(e,t,n){var o,r=P.length;for(e.prototype&&e.prototype.render?(o=new e(t,n),N.call(o,t,n)):((o=new N(t,n)).constructor=e,o.render=x);r--;)if(P[r].constructor===e)return o.nextBase=P[r].nextBase,P.splice(r,1),o;return o}function x(e,t,n){return this.constructor(e,n)}function L(e,t,n,o,i){e._disable||(e._disable=!0,e.__ref=t.ref,e.__key=t.key,delete t.ref,delete t.key,void 0===e.constructor.getDerivedStateFromProps&&(!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,o)),o&&o!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=o),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===r.syncComponentUpdates&&e.base?d(e):M(e,1,i)),e.__ref&&e.__ref(e))}function M(e,t,n,o){if(!e._disable){var i,a,s,l=e.props,c=e.state,p=e.context,f=e.prevProps||l,d=e.prevState||c,h=e.prevContext||p,y=e.base,b=e.nextBase,m=y||b,v=e._component,O=!1,E=h;if(e.constructor.getDerivedStateFromProps&&(c=u(u({},c),e.constructor.getDerivedStateFromProps(l,c)),e.state=c),y&&(e.props=f,e.state=d,e.context=h,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(l,c,p)?O=!0:e.componentWillUpdate&&e.componentWillUpdate(l,c,p),e.props=l,e.state=c,e.context=p),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!O){i=e.render(l,c,p),e.getChildContext&&(p=u(u({},p),e.getChildContext())),y&&e.getSnapshotBeforeUpdate&&(E=e.getSnapshotBeforeUpdate(f,d));var C,P,x=i&&i.nodeName;if("function"==typeof x){var N=g(i);(a=v)&&a.constructor===x&&N.key==a.__key?L(a,N,1,p,!1):(C=a,e._component=a=T(x,N,p),a.nextBase=a.nextBase||b,a._parentComponent=e,L(a,N,0,p,!1),M(a,1,n,!0)),P=a.base}else s=m,(C=v)&&(s=e._component=null),(m||1===t)&&(s&&(s._component=null),P=k(s,i,p,n||!y,m&&m.parentNode,!0));if(m&&P!==m&&a!==v){var R=m.parentNode;R&&P!==R&&(R.replaceChild(P,m),C||(m._component=null,S(m,!1)))}if(C&&A(C),e.base=P,P&&!o){for(var D=e,U=e;U=U._parentComponent;)(D=U).base=P;P._component=D,P._componentConstructor=D.constructor}}for(!y||n?_.unshift(e):O||(e.componentDidUpdate&&e.componentDidUpdate(f,d,E),r.afterUpdate&&r.afterUpdate(e));e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);w||o||j()}}function A(e){r.beforeUnmount&&r.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?A(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,b(t),P.push(e),C(t)),e.__ref&&e.__ref(null)}function N(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{},this._renderCallbacks=[]}function R(e,t,n){return k(n,e,{},!1,t,!1)}u(N.prototype,{setState:function(e,t){var n=this.prevState=this.state;"function"==typeof e&&(e=e(n,this.props)),this.state=u(u({},n),e),t&&this._renderCallbacks.push(t),d(this)},forceUpdate:function(e){e&&this._renderCallbacks.push(e),M(this,2)},render:function(){}});var D={h:s,createElement:s,cloneElement:c,Component:N,render:R,rerender:h,options:r};t.default=D},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NEW_NOTE="new-note",t.PAGE_REPLY="page-reply",t.ITEM_REPLY="item-reply",t.MESSAGE_SUCCESS="success",t.MESSAGE_ERROR="error",t.DEFAULT_REACJI=["👍","👎","🎉","😆","😢","😠"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openLink=function(e){e.preventDefault(),e.target.href&&chrome.tabs.create({url:e.target.href})},t.clone=function(e){return JSON.parse(JSON.stringify(e))},t.getAuthTab=function(){return new Promise(function(e,t){chrome.tabs.query({url:"https://omnibear.com/auth/success*"},function(n){n.length?e(n[0]):t("Auth tab not found")})})},t.logout=function(){["token","domain","authEndpoint","tokenEndpoint","micropubEndpoint"].map(function(e){return localStorage.removeItem(e)})},t.generateSlug=function(e){var t=e.toLocaleLowerCase().trim();t=t.replace(/\s/g,"-");for(var n=0,a=r.length;n<a;n++)t=t.replace(new RegExp(r.charAt(n),"g"),i.charAt(n));return(t=(t=t.replace(o,"")).replace(/\-\-+/g,"-")).split("-").splice(0,6).join("-")},t.getPageUrl=function(){return new Promise(function(e,t){var n=localStorage.getItem("pageTabId");chrome.tabs.get(Number(n),function(t){e(t.url)})})};var o=/[^A-Za-z0-9\-]/g,r="áäâàãåčçćďéěëèêẽĕȇęėíìîïňñóöòôõøðřŕšťúůüùûýÿžþÞĐđßÆa·/_,:;",i="aaaaaacccdeeeeeeeeeeiiiinnooooooorrstuuuuuyyzbBDdBAa------"},function(e,t,n){"use strict";var o=n(14),r=n(15),i=n(9);e.exports={formats:i,parse:r,stringify:o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLogs=s,t.clearLogs=function(){localStorage.setItem("log","[]")},t.info=l,t.warning=function(e,t){u(e,t,i)},t.error=function(e,t){u(e,t,a)};var o=n(7),r="info",i="warning",a="error";function s(){return JSON.parse(localStorage.getItem("log"))||[]}function u(e,t,n){if((0,o.getSettings)().debugLog||n===a){var r=s();r.length>100&&r.unshift();var i,u={message:e,type:n,timestamp:(i=new Date,i.getDate()+"/"+(i.getMonth()+1)+"/"+i.getFullYear()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()+"."+i.getMilliseconds())};t&&(t instanceof Error?u.data={message:t.message,stack:t.stack.trim().split("\n")}:u.data=t),r.push(u),function(e){localStorage.setItem("log",JSON.stringify(e))}(r)}}function l(e,t){u(e,t,r)}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=(o=n(12))&&o.__esModule?o:{default:o};t.default=new r.default({clientId:"https://omnibear.com",redirectUri:"https://omnibear.com/auth/success/",state:"very-secret-omnibear-state",me:localStorage.getItem("domain"),authEndpoint:localStorage.getItem("authEndpoint"),tokenEndpoint:localStorage.getItem("tokenEndpoint"),micropubEndpoint:localStorage.getItem("micropubEndpoint"),token:localStorage.getItem("token")})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSettings=function(){var e=JSON.parse(localStorage.getItem("settings"));return e||a},t.saveSettings=function(e){var t={};i.forEach(function(n){t[n]=e[n]}),localStorage.setItem("settings",JSON.stringify(t))},t.saveAuthenticationDetails=function(e,t,n){e&&(localStorage.setItem("domain",e),r.default.options.me=e),t&&(localStorage.setItem("token",t),r.default.options.token=t),n&&(localStorage.setItem("micropubEndpoint",n),r.default.options.micropubEndpoint=n)},t.getSyndicateOptions=function(){var e=localStorage.getItem("syndicateTo");return e&&"undefined"!==e?JSON.parse(e):(localStorage.setItem("syndicateTo","[]"),[])};var o,r=(o=n(6))&&o.__esModule?o:{default:o},i=["defaultToCurrentPage","autoSlug","closeAfterPosting","debugLog","reacji","slug","syndicateTo"],a={defaultToCurrentPage:!1,autoSlug:!1,closeAfterPosting:!0,debugLog:!1,reacji:n(2).DEFAULT_REACJI,slug:"mp-slug",syndicateTo:"mp-syndicate-to"}},function(e,t,n){"use strict";var o=Object.prototype.hasOwnProperty,r=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),i=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},o=0;o<e.length;++o)void 0!==e[o]&&(n[o]=e[o]);return n};e.exports={arrayToObject:i,assign:function(e,t){return Object.keys(t).reduce(function(e,n){return e[n]=t[n],e},e)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],o=0;o<t.length;++o)for(var r=t[o],i=r.obj[r.prop],a=Object.keys(i),s=0;s<a.length;++s){var u=a[s],l=i[u];"object"==typeof l&&null!==l&&-1===n.indexOf(l)&&(t.push({obj:i,prop:u}),n.push(l))}return function(e){for(var t;e.length;){var n=e.pop();if(t=n.obj[n.prop],Array.isArray(t)){for(var o=[],r=0;r<t.length;++r)void 0!==t[r]&&o.push(t[r]);n.obj[n.prop]=o}}return t}(t)},decode:function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},encode:function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),n="",o=0;o<t.length;++o){var i=t.charCodeAt(o);45===i||46===i||95===i||126===i||i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122?n+=t.charAt(o):i<128?n+=r[i]:i<2048?n+=r[192|i>>6]+r[128|63&i]:i<55296||i>=57344?n+=r[224|i>>12]+r[128|i>>6&63]+r[128|63&i]:(o+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(o)),n+=r[240|i>>18]+r[128|i>>12&63]+r[128|i>>6&63]+r[128|63&i])}return n},isBuffer:function(e){return null!==e&&void 0!==e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,n,r){if(!n)return t;if("object"!=typeof n){if(Array.isArray(t))t.push(n);else{if("object"!=typeof t)return[t,n];(r.plainObjects||r.allowPrototypes||!o.call(Object.prototype,n))&&(t[n]=!0)}return t}if("object"!=typeof t)return[t].concat(n);var a=t;return Array.isArray(t)&&!Array.isArray(n)&&(a=i(t,r)),Array.isArray(t)&&Array.isArray(n)?(n.forEach(function(n,i){o.call(t,i)?t[i]&&"object"==typeof t[i]?t[i]=e(t[i],n,r):t.push(n):t[i]=n}),t):Object.keys(n).reduce(function(t,i){var a=n[i];return o.call(t,i)?t[i]=e(t[i],a,r):t[i]=a,t},a)}}},function(e,t,n){"use strict";var o=String.prototype.replace,r=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return o.call(e,r,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(e,t,n){var o,r,i,a;i=function(){var e=/^;\s*([^"=]+)=(?:"([^"]+)"|([^";,]+)(?:[;,]|$))/,t=/^<([^>]*)>/,n=/^\s*,\s*/;return{parse:function(o,r){for(var i,a,s,u=r&&r.extended||!1,l=[];o&&(o=o.trim(),a=t.exec(o));){for(var c={link:a[1]},p=(o=o.slice(a[0].length)).match(n);o&&(!p||p.index>0)&&(i=e.exec(o));)p=(o=o.slice(i[0].length)).match(n),"rel"===i[1]||"rev"===i[1]?(s=(i[2]||i[3]).split(/\s+/),c[i[1]]=s):c[i[1]]=i[2]||i[3];l.push(c),o=o.replace(n,"")}return u?l:l.reduce(function(e,t){return t.rel&&t.rel.forEach(function(n){e[n]=t.link}),e},{})},stringify:function(e){var t=Object.keys(e).reduce(function(t,n){return t[e[n]]=t[e[n]]||[],t[e[n]].push(n),t},{});return Object.keys(t).reduce(function(e,n){return e.concat("<"+n+'>; rel="'+t[n].join(" ")+'"')},[]).join(", ")}}},a=this,void 0!==e&&e.exports?e.exports=i():"function"==typeof a.define&&a.define.amd?void 0===(r="function"==typeof(o=i)?o.call(t,n,t,e):o)||(e.exports=r):a.li=i()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=n(2);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){return(0,r.h)("div",{className:this.getClass()},this.props.children,this.props.location?(0,r.h)("span",null,":",(0,r.h)("br",null),(0,r.h)("a",{href:this.props.location},this.props.location)):null)}},{key:"getClass",value:function(){var e,t=(a(e={},i.MESSAGE_INFO,"message message--info"),a(e,i.MESSAGE_SUCCESS,"message message--success"),a(e,i.MESSAGE_ERROR,"message message--danger"),e);return t[this.props.type]||t[i.MESSAGE_INFO]}}]),t}();t.default=s},function(e,t,n){"use strict";n.r(t),function(e){var o=n(0);const r=o.g,i=o.i,a=o.h,s=o.f,u=o.d,l=o.e.parse;o.FormData&&!e.FormData&&(e.FormData=o.FormData),o.DOMParser&&!e.DOMParser&&(e.DOMParser=o.DOMParser),o.URL&&!e.URL&&(e.URL=o.URL);const c={me:"",scope:"post create delete update",token:"",authEndpoint:"",tokenEndpoint:"",micropubEndpoint:""},p=(e,t=null,n=null)=>({message:e,status:t,error:n});t.default=class{constructor(e={}){this.options=Object.assign({},c,e),this.create=this.create.bind(this),this.update=this.update.bind(this),this.delete=this.delete.bind(this),this.undelete=this.undelete.bind(this),this.postMicropub=this.postMicropub.bind(this),this.checkRequiredOptions=this.checkRequiredOptions.bind(this),this.getAuthUrl=this.getAuthUrl.bind(this),this.getEndpointsFromUrl=this.getEndpointsFromUrl.bind(this)}checkRequiredOptions(e){let t=[],n=!0;for(var o=0;o<e.length;o++){const r=e[o];this.options[r]||(n=!1,t.push(r))}return{pass:n,missing:t}}getEndpointsFromUrl(e){return new Promise((t,n)=>{let o={micropub:null,authorization_endpoint:null,token_endpoint:null},r=e;fetch(e).then(e=>{if(!e.ok)return n(p("Error getting page",e.status));r=e.url;const t=e.headers.get("link");if(t){const e=l(t);Object.keys(o).forEach(t=>{e[t]&&(o[t]=e[t])})}return e.text()}).then(a=>{const s=i(a,r);return this.options.me=e,s&&Object.keys(o).forEach(e=>{s[e]&&s[e][0]&&(o[e]=s[e][0])}),o.micropub&&o.authorization_endpoint&&o.token_endpoint?(this.options.micropubEndpoint=o.micropub,this.options.tokenEndpoint=o.token_endpoint,this.options.authEndpoint=o.authorization_endpoint,t({auth:this.options.authEndpoint,token:this.options.tokenEndpoint,micropub:this.options.micropubEndpoint})):n(p("Error getting microformats data"))}).catch(e=>n(p("Error fetching url",null,e)))})}getToken(e){return new Promise((t,n)=>{const o=this.checkRequiredOptions(["me","clientId","redirectUri","tokenEndpoint"]);if(!o.pass)return n(p("Missing required options: "+o.missing.join(", ")));const i={grant_type:"authorization_code",me:this.options.me,code:e,client_id:this.options.clientId,redirect_uri:this.options.redirectUri},s={method:"POST",body:a(i),headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",Accept:"application/json, application/x-www-form-urlencoded"}};fetch(this.options.tokenEndpoint,s).then(e=>{if(!e.ok)return n(p("Error getting token",e.status));const t=e.headers.get("Content-Type");return t&&0===t.indexOf("application/json")?e.json():e.text()}).then(e=>("string"==typeof e&&(e=r(e)),e.error_description?n(p(e.error_description)):e.error?n(p(e.error)):e.me&&e.scope&&e.access_token?e.me&&e.me.replace(/\/+$/,"")!==this.options.me.replace(/\/+$/,"")?n(p("The me values did not match")):(this.options.token=e.access_token,void t(e.access_token)):n(p("The token endpoint did not return the expected parameters")))).catch(e=>n(p("Error requesting token endpoint",null,e)))})}getAuthUrl(){return new Promise((e,t)=>{let n=this.checkRequiredOptions(["me","state"]);if(!n.pass)return t(p("Missing required options: "+n.missing.join(", ")));this.getEndpointsFromUrl(this.options.me).then(()=>{let n=this.checkRequiredOptions(["me","state","scope","clientId","redirectUri"]);if(!n.pass)return t(p("Missing required options: "+n.missing.join(", ")));const o={me:this.options.me,client_id:this.options.clientId,redirect_uri:this.options.redirectUri,response_type:"code",scope:this.options.scope,state:this.options.state};e(this.options.authEndpoint+"?"+a(o))}).catch(e=>t(p("Error getting auth url",null,e)))})}verifyToken(){return new Promise((e,t)=>{const n=this.checkRequiredOptions(["token","micropubEndpoint"]);if(!n.pass)return t(p("Missing required options: "+n.missing.join(", ")));const o={method:"GET",headers:{Authorization:"Bearer "+this.options.token}};fetch(this.options.micropubEndpoint,o).then(n=>n.ok?e(!0):t(p("Error verifying token",n.status))).catch(e=>t(p("Error verifying token",null,e)))})}create(e,t="json"){return this.postMicropub(e,t)}update(e,t){return this.postMicropub(Object.assign({action:"update",url:e},t))}delete(e){return this.postMicropub({action:"delete",url:e})}undelete(e){return this.postMicropub({action:"undelete",url:e})}postMicropub(e,t="json"){return new Promise((n,o)=>{const i=this.checkRequiredOptions(["token","micropubEndpoint"]);if(!i.pass)return o(p("Missing required options: "+i.missing.join(", ")));let u={method:"POST"};"json"==t?(u.body=JSON.stringify(e),u.headers={Authorization:"Bearer "+this.options.token,"Content-Type":"application/json",Accept:"application/json, application/x-www-form-urlencoded"}):"form"==t?(u.body=a(e,{arrayFormat:"brackets"}),u.headers={Authorization:"Bearer "+this.options.token,"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",Accept:"application/json, application/x-www-form-urlencoded"}):"multipart"==t&&(u.body=s(e),u.headers={Authorization:"Bearer "+this.options.token,Accept:"application/json, application/x-www-form-urlencoded"}),fetch(this.options.micropubEndpoint,u).then(e=>{if(!e.ok)return o(p("Error with micropub request",e.status));const t=e.headers.get("Location")||e.headers.get("location");if(t)return n(t);const r=e.headers.get("Content-Type");return r&&0===r.indexOf("application/json")?e.json():e.text()}).then(e=>("string"==typeof e&&(e=r(e)),e.error_description?o(p(e.error_description)):e.error?o(p(e.error)):n(e))).catch(e=>o(p("Error sending request",null,e)))})}postMedia(e){return new Promise((t,n)=>{const o=this.checkRequiredOptions(["token","mediaEndpoint"]);if(!o.pass)return n(p("Missing required options: "+o.missing.join(", ")));let r={method:"POST",body:s({file:e}),headers:{Authorization:"Bearer "+this.options.token,Accept:"*/*"}};fetch(this.options.mediaEndpoint,r).then(e=>{if(201!==e.status)return n(p("Error creating media",e.status));const o=e.headers.get("Location")||e.headers.get("location");return o?t(o):n(p("Media endpoint did not return a location",e.status))}).catch(e=>n(p("Error sending request")))})}query(e){return new Promise((t,n)=>{const o=this.checkRequiredOptions(["token","micropubEndpoint"]);if(!o.pass)return n(p("Missing required options: "+o.missing.join(", ")));const r=u(this.options.micropubEndpoint,{q:e}),i={method:"GET",headers:{Authorization:"Bearer "+this.options.token,"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",Accept:"application/json"}};fetch(r,i).then(t=>t.ok?t.json():n(p("Error getting "+e,t.status))).then(e=>t(e)).catch(t=>n(p("Error getting "+e,null,t)))})}querySource(e,t=[]){return new Promise((n,o)=>{const r=this.checkRequiredOptions(["token","micropubEndpoint"]);if(!r.pass)return o(p("Missing required options: "+r.missing.join(", ")));e=u(this.options.micropubEndpoint,{q:"source",url:e,properties:t});const i={method:"GET",headers:{Authorization:"Bearer "+this.options.token,"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",Accept:"application/json"}};fetch(e,i).then(e=>e.ok?e.json():o(p("Error getting source",e.status))).then(e=>n(e)).catch(e=>o(p("Error getting source",null,e)))})}}}.call(this,n(13))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var o=n(8),r=n(9),i={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},a=Date.prototype.toISOString,s={delimiter:"&",encode:!0,encoder:o.encode,encodeValuesOnly:!1,serializeDate:function(e){return a.call(e)},skipNulls:!1,strictNullHandling:!1},u=function e(t,n,r,i,a,u,l,c,p,f,d,h){var y=t;if("function"==typeof l)y=l(n,y);else if(y instanceof Date)y=f(y);else if(null===y){if(i)return u&&!h?u(n,s.encoder):n;y=""}if("string"==typeof y||"number"==typeof y||"boolean"==typeof y||o.isBuffer(y))return u?[d(h?n:u(n,s.encoder))+"="+d(u(y,s.encoder))]:[d(n)+"="+d(String(y))];var g,b=[];if(void 0===y)return b;if(Array.isArray(l))g=l;else{var m=Object.keys(y);g=c?m.sort(c):m}for(var v=0;v<g.length;++v){var _=g[v];a&&null===y[_]||(b=Array.isArray(y)?b.concat(e(y[_],r(n,_),r,i,a,u,l,c,p,f,d,h)):b.concat(e(y[_],n+(p?"."+_:"["+_+"]"),r,i,a,u,l,c,p,f,d,h)))}return b};e.exports=function(e,t){var n=e,a=t?o.assign({},t):{};if(null!==a.encoder&&void 0!==a.encoder&&"function"!=typeof a.encoder)throw new TypeError("Encoder has to be a function.");var l=void 0===a.delimiter?s.delimiter:a.delimiter,c="boolean"==typeof a.strictNullHandling?a.strictNullHandling:s.strictNullHandling,p="boolean"==typeof a.skipNulls?a.skipNulls:s.skipNulls,f="boolean"==typeof a.encode?a.encode:s.encode,d="function"==typeof a.encoder?a.encoder:s.encoder,h="function"==typeof a.sort?a.sort:null,y=void 0!==a.allowDots&&a.allowDots,g="function"==typeof a.serializeDate?a.serializeDate:s.serializeDate,b="boolean"==typeof a.encodeValuesOnly?a.encodeValuesOnly:s.encodeValuesOnly;if(void 0===a.format)a.format=r.default;else if(!Object.prototype.hasOwnProperty.call(r.formatters,a.format))throw new TypeError("Unknown format option provided.");var m,v,_=r.formatters[a.format];"function"==typeof a.filter?n=(v=a.filter)("",n):Array.isArray(a.filter)&&(m=v=a.filter);var w,O=[];if("object"!=typeof n||null===n)return"";w=a.arrayFormat in i?a.arrayFormat:"indices"in a?a.indices?"indices":"repeat":"indices";var E=i[w];m||(m=Object.keys(n)),h&&m.sort(h);for(var j=0;j<m.length;++j){var k=m[j];p&&null===n[k]||(O=O.concat(u(n[k],k,E,c,p,f?d:null,v,h,y,g,_,b)))}var S=O.join(l),C=!0===a.addQueryPrefix?"?":"";return S.length>0?C+S:""}},function(e,t,n){"use strict";var o=n(8),r=Object.prototype.hasOwnProperty,i={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:o.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},a=function(e,t,n){if(e){var o=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,i=/(\[[^[\]]*])/g,a=/(\[[^[\]]*])/.exec(o),s=a?o.slice(0,a.index):o,u=[];if(s){if(!n.plainObjects&&r.call(Object.prototype,s)&&!n.allowPrototypes)return;u.push(s)}for(var l=0;null!==(a=i.exec(o))&&l<n.depth;){if(l+=1,!n.plainObjects&&r.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(a[1])}return a&&u.push("["+o.slice(a.index)+"]"),function(e,t,n){for(var o=t,r=e.length-1;r>=0;--r){var i,a=e[r];if("[]"===a)i=(i=[]).concat(o);else{i=n.plainObjects?Object.create(null):{};var s="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,u=parseInt(s,10);!isNaN(u)&&a!==s&&String(u)===s&&u>=0&&n.parseArrays&&u<=n.arrayLimit?(i=[])[u]=o:i[s]=o}o=i}return o}(u,t,n)}};e.exports=function(e,t){var n=t?o.assign({},t):{};if(null!==n.decoder&&void 0!==n.decoder&&"function"!=typeof n.decoder)throw new TypeError("Decoder has to be a function.");if(n.ignoreQueryPrefix=!0===n.ignoreQueryPrefix,n.delimiter="string"==typeof n.delimiter||o.isRegExp(n.delimiter)?n.delimiter:i.delimiter,n.depth="number"==typeof n.depth?n.depth:i.depth,n.arrayLimit="number"==typeof n.arrayLimit?n.arrayLimit:i.arrayLimit,n.parseArrays=!1!==n.parseArrays,n.decoder="function"==typeof n.decoder?n.decoder:i.decoder,n.allowDots="boolean"==typeof n.allowDots?n.allowDots:i.allowDots,n.plainObjects="boolean"==typeof n.plainObjects?n.plainObjects:i.plainObjects,n.allowPrototypes="boolean"==typeof n.allowPrototypes?n.allowPrototypes:i.allowPrototypes,n.parameterLimit="number"==typeof n.parameterLimit?n.parameterLimit:i.parameterLimit,n.strictNullHandling="boolean"==typeof n.strictNullHandling?n.strictNullHandling:i.strictNullHandling,""===e||null===e||void 0===e)return n.plainObjects?Object.create(null):{};for(var s="string"==typeof e?function(e,t){for(var n={},o=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,a=t.parameterLimit===1/0?void 0:t.parameterLimit,s=o.split(t.delimiter,a),u=0;u<s.length;++u){var l,c,p=s[u],f=p.indexOf("]="),d=-1===f?p.indexOf("="):f+1;-1===d?(l=t.decoder(p,i.decoder),c=t.strictNullHandling?null:""):(l=t.decoder(p.slice(0,d),i.decoder),c=t.decoder(p.slice(d+1),i.decoder)),r.call(n,l)?n[l]=[].concat(n[l]).concat(c):n[l]=c}return n}(e,n):e,u=n.plainObjects?Object.create(null):{},l=Object.keys(s),c=0;c<l.length;++c){var p=l[c],f=a(p,s[p],n);u=o.merge(u,f,n)}return o.compact(u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){return(0,r.h)("footer",{className:"footer"},this.props.domain?(0,r.h)("div",{className:"footer__message"},"Authenticated to ",(0,r.h)("strong",null,this.props.domain)):null,this.props.onSettings?(0,r.h)("button",{className:"button-link",type:"button",onClick:this.props.onSettings},"Settings"):null,this.props.onLogs?(0,r.h)("button",{className:"button-link",type:"button",onClick:this.props.onLogs},"Logs"):null,this.props.onLogout?(0,r.h)("button",{className:"button-link",type:"button",onClick:this.props.onLogout},"Logout"):null)}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDraft=i,t.saveDraft=a,t.deleteDraft=function(){a({h:"entry",content:"",category:[],"mp-slug":"","mp-syndicate-to":i()["mp-syndicate-to"]})};var o=["h","content","category","mp-slug","mp-syndicate-to"],r={h:"entry",content:"",category:[],"mp-slug":"","mp-syndicate-to":[]};function i(){return JSON.parse(localStorage.getItem("draft"))||r}function a(e){var t={};o.forEach(function(n){t[n]=e[n]}),localStorage.setItem("draft",JSON.stringify(t))}},,function(e,t,n){"use strict";var o,r=n(1),i=(o=n(20))&&o.__esModule?o:{default:o};document.addEventListener("DOMContentLoaded",function(){(0,r.render)((0,r.h)(i.default,null),document.body)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=p(n(21)),a=p(n(22)),s=p(n(30)),u=p(n(11)),l=p(n(33)),c=n(3);function p(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setDefaultView=function(){n.isAuthenticated()?(n.setState({currentView:"new-note"}),n.getPageUrl()):n.setState({currentView:"login"})},n.displayMessage=function(e,t,o){n.setState({currentView:"feedback",message:e,postLocation:"string"==typeof o?o:null})},n.handleSettings=function(){n.setState({currentView:"settings"})},n.handleLogs=function(){n.setState({currentView:"logs"})},n.handleLogout=function(){(0,c.logout)(),n.setState({currentView:"login"})},n.state={pageUrl:""},n.setDefaultView(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){switch(this.state.currentView){case"login":return(0,r.h)(i.default,{handleSettings:this.handleSettings,handleLogs:this.handleLogs});case"feedback":return(0,r.h)(u.default,{location:this.state.postLocation},this.state.message);case"settings":return(0,r.h)(l.default,{onClose:this.setDefaultView});case"logs":return(0,r.h)(s.default,{onClose:this.setDefaultView});default:return(0,r.h)(a.default,{handleLogout:this.handleLogout,handleSettings:this.handleSettings,handleLogs:this.handleLogs,userFeedback:this.displayMessage,pageUrl:this.state.pageUrl})}}},{key:"isAuthenticated",value:function(){return!!localStorage.getItem("token")&&!!localStorage.getItem("micropubEndpoint")}},{key:"getPageUrl",value:function(){var e=this;(0,c.getPageUrl)().then(function(t){e.setState({pageUrl:t})})}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=p(n(11)),a=p(n(16)),s=n(3),u=p(n(6)),l=n(7),c=n(5);function p(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=function(e){n.setState({domain:e.target.value,hasErrors:!1})},n.handleSubmit=function(e){e.preventDefault();var t=n.getNormalizedDomain();n.setState({isLoading:!0,domain:t}),(0,c.info)("Begin authentication to "+t),u.default.options.me=t,u.default.getAuthUrl().then(function(e){chrome.runtime.sendMessage({action:"begin-auth",payload:{authUrl:e,domain:n.state.domain,metadata:{authEndpoint:u.default.options.authEndpoint,tokenEndpoint:u.default.options.tokenEndpoint,micropub:u.default.options.micropubEndpoint}}})}).catch(function(e){return console.log(e.message),n.setState({hasErrors:!0,errorMessage:"Missing micropub data on "+n.state.domain+". Please ensure the following links are present: authorization_endpoint, token_endpoint, micropub",isLoading:!1})})},n.state={logsEnabled:(0,l.getSettings)().debugLog},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.input.focus()},150)}},{key:"render",value:function(){var e=this;return(0,r.h)("div",null,(0,r.h)("form",{class:"container",method:"GET",onSubmit:this.handleSubmit},(0,r.h)("p",null,"To use Omnibear, sign in with your domain. Your website will need to support"," ",(0,r.h)("a",{href:"http://indieweb.org/micropub",onClick:s.openLink},"Micropub")," ","for creating new posts."),(0,r.h)("div",{class:"fields-inline"},(0,r.h)("input",{type:"text",name:"me",placeholder:"https://example.com",className:"fields-inline__fill",value:this.state.domain,onInput:this.handleChange,disabled:this.state.isLoading,ref:function(t){return e.input=t}}),(0,r.h)("button",{type:"submit",disabled:this.state.isLoading,className:this.state.isLoading?"button is-loading":"button"},"Sign in")),this.state.hasErrors?(0,r.h)(i.default,{type:"error"},this.state.errorMessage||"Error"):null),(0,r.h)(a.default,{onSettings:this.props.handleSettings,onLogs:this.state.logsEnabled?this.props.handleLogs:null}))}},{key:"getNormalizedDomain",value:function(){return this.state.domain.startsWith("http://")||this.state.domain.startsWith("https://")?this.state.domain:"http://"+this.state.domain}},{key:"getFields",value:function(e){return["redirect_uri=https://omnibear.com/auth/success/","client_id=https://omnibear.com","response_type=code","scope=create","me="+e].join("&")}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=g(n(23)),a=g(n(11)),s=g(n(26)),u=g(n(28)),l=g(n(16)),c=n(17),p=n(3),f=g(n(6)),d=n(2),h=n(7),y=n(5);function g(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.handleLike=function(){var e=n.getCurrentUrl();e?n.postEntry({h:"entry","like-of":e}).then(function(e){var t=n.state.postType===d.ITEM_REPLY?"Item":"Page";n.flashSuccessMessage(t+" liked successfully",e)}).catch(function(e){n.flashErrorMessage("Error posting like",e)}):(0,y.warning)("Cannot send like; no current URL found")},n.handleRepost=function(){var e=n.getCurrentUrl();e?n.postEntry({h:"entry","repost-of":e}).then(function(e){var t=n.state.postType===d.ITEM_REPLY?"Item":"Page";n.flashSuccessMessage(t+" reposted successfully",e)}).catch(function(e){n.flashErrorMessage("Error reposting",e)}):(0,y.warning)("Cannot send repost; no current URL found")},n.handleReacji=function(e){var t=n.getCurrentUrl();t?n.postEntry({h:"entry",content:e,"in-reply-to":t}).then(function(e){var t=n.state.postType===d.ITEM_REPLY?"Item":"Page";n.flashSuccessMessage(t+" reacted to successfully",e)}).catch(function(e){n.flashErrorMessage("Error reacting",e)}):(0,y.warning)("Cannot send reacji; no current URL found")},n.updateEntry=function(e){n.setState({entry:e})},n.handleSubmit=function(e){n.state.postType!==d.NEW_NOTE&&(e["in-reply-to"]=n.getCurrentUrl()),n.postEntry(e).then(function(e){var t=n.state.postType===d.NEW_NOTE?"Note":"Reply";(0,c.deleteDraft)(),n.flashSuccessMessage(t+" posted successfully",e)}).catch(function(e){e.status>=400&&e.status<500?n.flashErrorMessage("Error authenticating to micropub endpoint. Try logging out and back in.",e):n.flashErrorMessage("Error posting Note",e)})},n.changeView=function(e){var t=void 0;switch(e){case d.NEW_NOTE:t=null;break;case d.PAGE_REPLY:t=localStorage.getItem("pageUrl");break;case d.ITEM_REPLY:t=localStorage.getItem("selectedEntry")}n.setState({url:t,postType:e}),n.form.focus()};var o=localStorage.getItem("selectedEntry"),r=(0,h.getSettings)(),i=(0,c.getDraft)();return n.state={postType:n.getPostType(r),selectedEntry:localStorage.getItem("selectedEntry"),userDomain:localStorage.getItem("domain"),entry:i,hasSelectedEntry:!!o,isDisabled:!1,isLoading:!1,settings:r,syndicateOptions:(0,h.getSyndicateOptions)()},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"getPostType",value:function(e){var t=localStorage.getItem("selectedEntry");return-1!==location.search.indexOf("reply=true")||e.defaultToCurrentPage?t?d.ITEM_REPLY:d.PAGE_REPLY:d.NEW_NOTE}},{key:"getCurrentUrl",value:function(){switch(this.state.postType){case d.NEW_NOTE:return null;case d.PAGE_REPLY:return this.props.pageUrl;case d.ITEM_REPLY:return this.state.selectedEntry}}},{key:"render",value:function(){var e=this,t=this.state,n=t.postType,o=t.isDisabled,c=t.isLoading,p=t.settings,f=t.userDomain,h=t.entry,y=t.syndicateOptions,g=t.hasSelectedEntry,b=t.errorMessage,m=this.props,v=m.handleSettings,_=m.handleLogout;return(0,r.h)("div",null,(0,r.h)(s.default,{postType:n,onChange:this.changeView,hasSelectedEntry:g}),(0,r.h)(i.default,{postType:n,url:this.getCurrentUrl(),onLike:this.handleLike,onRepost:this.handleRepost,onReacji:this.handleReacji,isDisabled:c,settings:p}),(0,r.h)("div",{className:"container"},(0,r.h)(u.default,{postType:n,entry:h,settings:p,syndicateOptions:y,updateEntry:this.updateEntry,onSubmit:this.handleSubmit,isDisabled:o,isLoading:c,ref:function(t){return e.form=t}}),b?(0,r.h)(a.default,{type:d.MESSAGE_ERROR},b):null),(0,r.h)(l.default,{domain:f,onSettings:v,onLogs:this.state.settings.debugLog?this.props.handleLogs:null,onLogout:_}))}},{key:"flashSuccessMessage",value:function(e,t){(0,y.info)(e,t),this.props.userFeedback(e,d.MESSAGE_SUCCESS,t),this.state.settings.closeAfterPosting&&setTimeout(function(){window.close()},3e3)}},{key:"flashErrorMessage",value:function(e,t){var n=this;(0,y.error)(e,t),this.setState({errorMessage:e,isDisabled:!1,isLoading:!1}),setTimeout(function(){n.state.errorMessage===e&&n.setState({errorMessage:!1})},4e3)}},{key:"postEntry",value:function(e){this.setState({isDisabled:!0,isLoading:!0});var t=(0,p.clone)(e),n=this.state.settings.slug,o=this.state.settings.syndicateTo;return n&&"mp-slug"!==n&&(t[n]=t["mp-slug"],delete t["mp-slug"]),o&&"mp-syndicate-to"!==o&&(t[o]=t["mp-syndicate-to"],delete t["mp-syndicate-to"]),f.default.create(t,"form")}}]),t}();t.default=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=n(2),a=u(n(24)),s=u(n(25));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=o=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.renderReacji=function(e,t){return(0,r.h)("li",{key:e},(0,r.h)("button",{onClick:function(){return o.props.onReacji(e)},disabled:o.props.isDisabled},e))},l(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){return this.props.postType!==i.NEW_NOTE&&this.props.url?(0,r.h)("div",null,(0,r.h)("div",{className:"info-banner"},this.props.url),(0,r.h)("div",{className:"container"},(0,r.h)("h2",{className:"minor-heading"},"Quick Actions"),this.renderQuickActions())):null}},{key:"renderQuickActions",value:function(){var e=this.props.settings,t=void 0;return t=e&&e.reacji?e.reacji:i.DEFAULT_REACJI,(0,r.h)("ul",{className:"quick-actions"},(0,r.h)("li",null,(0,r.h)("button",{onClick:this.props.onRepost,disabled:this.props.isDisabled},(0,r.h)(s.default,null)," repost")),(0,r.h)("li",null,(0,r.h)("button",{onClick:this.props.onLike,disabled:this.props.isDisabled},(0,r.h)(a.default,null)," like")),t.map(this.renderReacji))}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){return(0,r.h)("svg",{className:"svg-heart",viewBox:"-5 0 110 125"},(0,r.h)("desc",null,"heart"),(0,r.h)("path",{d:"M49.99,96.266c4.246-2.908,50.016-34.809,50.016-63.154c0-17.711-10.822-29.378-26.424-29.378  c-14.357,0-22.389,13.18-23.582,15.29c-1.194-2.109-9.225-15.29-23.582-15.29c-15.603,0-26.425,11.667-26.425,29.378  c0,28.345,45.724,60.246,49.97,63.154H49.99z",fill:"transparent",stroke:"var(--red)","stroke-width":"10"}))}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){return(0,r.h)("svg",{className:"svg-repost",viewBox:"390 45 396 225"},(0,r.h)("path",{d:" M 570 220 L 490 220 L 490 160 L 520 160 C 530.71 160 540 151.53 540 140 C 540 132.5 536.09 127.66 530 120 L 490 71.88 C 483.90999999999997 64.69 478.13 60 470 60 C 461.87 60 456.09000000000003 64.69 450 71.88 L 410 120 C 403.91 127.66 400 132.5 400 140 C 400 151.53 409.29 160 420 160 L 450 160 L 450 240 C 450 251.04 458.96 260 470 260 L 570 260 C 581.04 260 590 251.04 590 240 C 590 228.96 581.04 220 570 220 Z  M 760 160 L 730 160 L 730 80 C 730 68.96 721.04 60 710 60 L 610 60 C 598.96 60 590 68.96 590 80 C 590 91.03999999999999 598.96 100 610 100 L 690 100 L 690 160 L 660 160 C 649.29 160 640 168.47000000000003 640 180 C 640 187.5 643.91 192.34000000000003 650 200 L 690 248.13 C 696.09 255.31 701.88 260 710 260 C 718.12 260 723.91 255.31 730 248.12 L 770 200 C 776.09 192.34000000000003 780 187.5 780 180 C 780 168.47000000000003 770.71 160 760 160 Z ",fill:"transparent",stroke:"var(--green)","stroke-width":"20"}))}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(1),a=(o=n(27))&&o.__esModule?o:{default:o},s=n(2),u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),r(t,[{key:"render",value:function(){return this.props.postType,(0,i.h)("div",{className:"tabs"},this.renderNewNote(),this.renderPageReply(),this.renderItemReply())}},{key:"renderNewNote",value:function(){return(0,i.h)(a.default,{isActive:this.props.postType===s.NEW_NOTE,onClick:this.switchTo(s.NEW_NOTE)},"New note")}},{key:"renderPageReply",value:function(){return(0,i.h)(a.default,{isActive:this.props.postType===s.PAGE_REPLY,onClick:this.switchTo(s.PAGE_REPLY)},"Current page")}},{key:"renderItemReply",value:function(){return(0,i.h)(a.default,{isActive:this.props.postType===s.ITEM_REPLY,isDisabled:!this.props.hasSelectedEntry,onClick:this.switchTo(s.ITEM_REPLY)},"Selected entry")}},{key:"switchTo",value:function(e){var t=this;return function(){t.props.onChange(e)}}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1);function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var a=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=o=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleClick=function(e){e.preventDefault(),o.props.onClick()},i(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){return(0,r.h)("button",{className:this.getClass(),disabled:this.props.isDisabled,onClick:this.handleClick},this.props.children)}},{key:"getClass",value:function(){return this.props.isActive?"tab is-active":"tab"}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(1),a=(o=n(29))&&o.__esModule?o:{default:o},s=n(17),u=n(3),l=n(2),c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.focus=function(){n.content.focus()},n.updateSlug=function(e){var t=e.target.value.trim(),o=(0,u.clone)(n.props.entry);o["mp-slug"]=t,n.props.updateEntry(o),n.setState({isSlugEdited:""!==t})},n.updateContent=function(e){var t=e.target.value,o=(0,u.clone)(n.props.entry);o.content=t,n.shouldAutoSlug()&&(o["mp-slug"]=(0,u.generateSlug)(t)),n.props.updateEntry(o)},n.updateSyndicateTo=function(e){var t=(0,u.clone)(n.props.entry);t["mp-syndicate-to"]=e,n.props.updateEntry(t)},n.onSubmit=function(e){e.preventDefault(),n.props.onSubmit(n.props.entry)},n.state={isSlugEdited:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),r(t,[{key:"componentDidMount",value:function(){setTimeout(this.focus,150)}},{key:"componentDidUpdate",value:function(){(0,s.saveDraft)(this.props.entry)}},{key:"render",value:function(){var e=this,t=this.props,n=t.postType,o=t.entry,r=t.syndicateOptions,s=t.isDisabled,u=t.isLoading;return(0,i.h)("form",{onSubmit:this.onSubmit},(0,i.h)("div",null,(0,i.h)("label",{for:"input-content"},n===l.NEW_NOTE?"Content":"Reply"),(0,i.h)("textarea",{id:"input-content",value:o.content,onInput:this.updateContent,onBlur:this.updateContent,rows:"4",disabled:s,ref:function(t){e.content=t}}),(0,i.h)("div",{class:"input-extra"},o.content.length)),(0,i.h)("div",null,(0,i.h)("label",{for:"input-category"},"Tags (space separated)"),(0,i.h)("input",{id:"input-category",type:"text",placeholder:"e.g. web  personal",value:o.category.join(" "),onChange:this.updateFieldArray("category"),disabled:s})),(0,i.h)("div",null,(0,i.h)("label",{for:"input-slug"},"Slug"),(0,i.h)("input",{id:"input-slug",type:"text",name:"mp-slug",value:o["mp-slug"],onInput:this.updateSlug,disabled:s})),(0,i.h)(a.default,{options:r,selected:o["mp-syndicate-to"],onUpdate:this.updateSyndicateTo,isDisabled:s}),(0,i.h)("button",{type:"submit",disabled:s||!o.content,className:u?"button is-loading":"button"},"Post"))}},{key:"updateFieldArray",value:function(e){var t=this;return function(n){n.preventDefault();var o=(0,u.clone)(t.props.entry);o[e]=n.target.value.trim().split(" "),t.props.updateEntry(o)}}},{key:"shouldAutoSlug",value:function(){return!this.state.isSlugEdited&&!(!this.props.settings||!this.props.settings.autoSlug)}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1);function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var a=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,s=Array(a),u=0;u<a;u++)s[u]=arguments[u];return n=o=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.renderOption=function(e){var t=o.props,n=t.selected,i=t.isDisabled,a=!!n&&n.indexOf(e.uid)>-1;return(0,r.h)("label",null,(0,r.h)("input",{type:"checkbox",checked:a,disabled:i,onClick:o.toggleOption(e.uid)}),e.name)},i(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){var e=this.props.options;return e&&e.length?(0,r.h)("div",null,(0,r.h)("div",{class:"label"},"Syndicate to"),e.map(this.renderOption)):null}},{key:"toggleOption",value:function(e){var t=this;return function(n){var o=t.props.selected||[];if(n.target.checked)o.push(e),t.props.onUpdate(o);else{var r=o.indexOf(e);o.splice(r,1),t.props.onUpdate(o)}}}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(1),a=(o=n(31))&&o.__esModule?o:{default:o},s=n(5);function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=o=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),o.clearLogs=function(){(0,s.clearLogs)(),o.forceUpdate()},u(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),r(t,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){e.forceUpdate()},2e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this.props.onClose,t=(0,s.getLogs)();return(0,i.h)("div",null,(0,i.h)("h1",{className:"section-heading"},"Logs"),(0,i.h)("div",{class:"container"},t.length?(0,i.h)("ul",{className:"logs"},t.map(function(e){return(0,i.h)(a.default,{log:e})})):(0,i.h)("p",{className:"metadata"},"No logs found"),(0,i.h)("p",{className:"text-right"},(0,i.h)("button",{type:"button",onClick:this.clearLogs},"Clear logs"))),(0,i.h)("footer",{className:"footer"},(0,i.h)("button",{className:"button-link",type:"button",onClick:e},"Close logs")))}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(1),a=(o=n(32))&&o.__esModule?o:{default:o},s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggle=function(){n.setState({isExpanded:!n.state.isExpanded})},n.state={isExpanded:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),r(t,[{key:"render",value:function(){var e=this.props.log;return(0,i.h)("li",null,(0,i.h)("button",{type:"button",className:this.getClass(),onClick:this.toggle},(0,i.h)("time",null,e.timestamp),(0,i.h)("div",null,e.message)),this.state.isExpanded?(0,i.h)(a.default,{details:e.data}):null)}},{key:"getClass",value:function(){return["log","log--"+this.props.log.type,this.state.isExpanded?"is-expanded":"",this.props.log.data?"has-data":""].join(" ")}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){var e=this.props.details;return(0,r.h)("div",{class:"log-details"},this.renderDetail(e,!0))}},{key:"renderDetail",value:function(e,t){var n=this,o=(t?0:1)+"em";return"string"==typeof e?(0,r.h)("span",null,e):Array.isArray(e)?(0,r.h)("div",{style:{marginLeft:o}},"[",e.map(function(e){return(0,r.h)("div",{style:{marginLeft:o}},n.renderDetail(e),",")}),"]"):[(0,r.h)("span",null,"{"),(0,r.h)("div",{style:{marginLeft:o}},Object.keys(e).map(function(t){return(0,r.h)("div",{style:{marginLeft:"1em"}},t,": ",n.renderDetail(e[t]))})),(0,r.h)("span",null,"}")]}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=c(n(34)),a=c(n(35)),s=c(n(36)),u=(n(2),n(7)),l=n(5);function c(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.set=function(e){return function(t){n.setState(p({},e,t))}},n.save=function(e){e.preventDefault();var t=n.state,o=t.me,r=t.token,i=t.micropubEndpoint;(0,u.saveSettings)(n.state),(0,u.saveAuthenticationDetails)(o,r,i),n.state.debugLog||(0,l.clearLogs)(),n.props.onClose()};var o=(0,u.getSettings)();return o.me=localStorage.getItem("domain"),o.micropubEndpoint=localStorage.getItem("micropubEndpoint"),o.token=localStorage.getItem("token"),o.showAuthenticationDetails=!1,n.setState(o),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){var e=this.state,t=e.defaultToCurrentPage,n=e.autoSlug,o=e.closeAfterPosting,u=e.debugLog,l=e.reacji,c=e.slug,p=e.syndicateTo,f=e.me,d=e.micropubEndpoint,h=e.token;return e.showAuthenticationDetails,(0,r.h)("div",null,(0,r.h)("h1",{class:"section-heading"},"Settings"),(0,r.h)("div",{class:"container"},(0,r.h)("form",{class:"settings-form",onSubmit:this.save},(0,r.h)("label",null,(0,r.h)("input",{type:"checkbox",checked:t,onChange:this.updateBoolean("defaultToCurrentPage")}),"Always open in “Reply to current page” mode"),(0,r.h)("label",null,(0,r.h)("input",{type:"checkbox",checked:n,onChange:this.updateBoolean("autoSlug")}),"Automatically generate slug from post content"),(0,r.h)("label",null,(0,r.h)("input",{type:"checkbox",checked:o,onChange:this.updateBoolean("closeAfterPosting")}),"Close Omnibear window after posting"),(0,r.h)("label",null,(0,r.h)("input",{type:"checkbox",checked:u,onChange:this.updateBoolean("debugLog")}),"Record debug logs"),(0,r.h)(i.default,{reacji:l,onChange:this.set("reacji")}),(0,r.h)(a.default,{slug:c,syndicateTo:p,onChange:this.set}),(0,r.h)(s.default,{me:f,micropubEndpoint:d,token:h,onChange:this.set}),(0,r.h)("div",{class:"form-buttons"},(0,r.h)("button",{type:"submit",className:"button"},"Save"),(0,r.h)("button",{type:"button",className:"button-link",onClick:this.props.onClose},"Cancel")))))}},{key:"update",value:function(e){var t=this;return function(n){t.set(e)(n.target.value)}}},{key:"updateBoolean",value:function(e){var t=this;return function(n){t.setState(p({},e,n.target.checked))}}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderReacji=function(e,t){return(0,r.h)("div",{className:"reacji-tag",key:e},e,(0,r.h)("button",{type:"button",onClick:n.deleteReacji(t)},"×"))},n.update=function(e){n.setState({value:e.target.value})},n.addReacji=function(){var e=n.state.value,t=n.props.reacji;e&&-1===t.indexOf(e)&&(t.push(e),n.props.onChange(t),n.setState({value:""}))},n.setState({value:""}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){var e=this.props.reacji;return(0,r.h)("div",null,(0,r.h)("label",null,"Quick replies (“Reacji”)"),(0,r.h)("div",{className:"reacji-row"},e.map(this.renderReacji)),(0,r.h)("div",{class:"input-inline"},(0,r.h)("input",{type:"text",value:this.state.value,onChange:this.update}),(0,r.h)("button",{type:"button",onClick:this.addReacji},"Add")))}},{key:"deleteReacji",value:function(e){var t=this;return function(){var n=t.props.reacji;n.splice(e,1),t.props.onChange(n)}}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showAuthenticationDetails=function(){n.setState({showFields:!0})},n.state={showFields:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){var e=this.props,t=e.slug,n=e.syndicateTo;return(0,r.h)("fieldset",null,(0,r.h)("legend",null,"Customize endpoint fields"),(0,r.h)("div",{class:"settings-form__description"},"If your micropub server expects custom or legacy fieldnames, you can specify those here"),this.state.showFields?[(0,r.h)("div",null,(0,r.h)("label",{htmlFor:"slug"},"Slug"),(0,r.h)("input",{id:"slug",type:"text",value:t,onChange:this.update("slug")}),(0,r.h)("div",{class:"settings-form__description"},"Choose the name of the field that the slug will be sent in. This should be ",(0,r.h)("code",null,"mp-slug")," for up-to-date endpoints.")),(0,r.h)("div",null,(0,r.h)("label",{htmlFor:"syndicate-to"},"Syndicate To"),(0,r.h)("input",{id:"syndicate-to",type:"text",value:n,onChange:this.update("syndicateTo")}),(0,r.h)("div",{class:"settings-form__description"},"Choose the name of the field that the syndicate-to UIDs will be sent in. This should be ",(0,r.h)("code",null,"mp-syndicate-to")," for up-to-date endpoints."))]:(0,r.h)("div",{class:"text-right"},(0,r.h)("button",{type:"button",onClick:this.showAuthenticationDetails},"Show")))}},{key:"update",value:function(e){var t=this;return function(n){t.props.onChange(e)(n.target.value)}}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showAuthenticationDetails=function(){n.setState({showFields:!0})},n.state={showFields:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"render",value:function(){return(0,r.h)("fieldset",null,(0,r.h)("legend",null,"Authentication details (advanced)"),(0,r.h)("div",{class:"settings-form__description"},"These values are set automatically upon logging in. Only edit them if you are having trouble authenticating and wish to do so manually."),this.state.showFields?[(0,r.h)("div",null,(0,r.h)("label",{htmlFor:"me"},"Me (domain name)"),(0,r.h)("input",{id:"me",type:"text",value:this.props.me,onChange:this.update("me"),placeholder:"https://example.com"})),(0,r.h)("div",null,(0,r.h)("label",{htmlFor:"mp-endpoint"},"Micropub endpoint"),(0,r.h)("input",{id:"mp-endpoint",type:"text",value:this.props.micropubEndpoint,onChange:this.update("micropubEndpoint"),placeholder:"https://example.com/micropub"})),(0,r.h)("div",null,(0,r.h)("label",{htmlFor:"token"},"Token"),(0,r.h)("input",{id:"token",type:"text",value:this.props.token,onChange:this.update("token")}))]:(0,r.h)("div",{class:"text-right"},(0,r.h)("button",{type:"button",onClick:this.showAuthenticationDetails},"Show")))}},{key:"update",value:function(e){var t=this;return function(n){t.props.onChange(e)(n.target.value)}}}]),t}();t.default=i}]);